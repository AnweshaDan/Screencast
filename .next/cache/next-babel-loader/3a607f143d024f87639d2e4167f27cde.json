{"ast":null,"code":"import 'firebase/messaging';\nimport firebase from 'firebase/app';\nimport localforage from 'localforage';\nconst firebaseCloudMessaging = {\n  //checking whether token is available in indexed DB\n  tokenInlocalforage: async () => {\n    return localforage.getItem('fcm_token');\n  },\n  //initializing firebase app\n  init: async function () {\n    if (!firebase.apps.length) {\n      firebase.initializeApp({\n        messagingSenderId: \"447447903811\"\n      });\n\n      try {\n        const messaging = firebase.messaging();\n        const tokenInLocalForage = await this.tokenInlocalforage(); //if FCM token is already there just return the token\n\n        if (tokenInLocalForage !== null) {\n          return tokenInLocalForage;\n        } //requesting notification permission from browser\n\n\n        const status = await Notification.requestPermission();\n\n        if (status && status === 'granted') {\n          //getting token from FCM\n          const fcm_token = await messaging.getToken();\n\n          if (fcm_token) {\n            //setting FCM token in indexed db using localforage\n            localforage.setItem('fcm_token', token);\n            console.log('fcm token', token); //return the FCM token after saving it\n\n            return token;\n          }\n        }\n      } catch (error) {\n        console.error(error);\n        return null;\n      }\n    }\n  }\n};\nexport { firebaseCloudMessaging };","map":{"version":3,"sources":["/home/anwesha/Desktop/screencast/webPush.js"],"names":["firebase","localforage","firebaseCloudMessaging","tokenInlocalforage","getItem","init","apps","length","initializeApp","messagingSenderId","messaging","tokenInLocalForage","status","Notification","requestPermission","fcm_token","getToken","setItem","token","console","log","error"],"mappings":"AAAA,OAAO,oBAAP;AACA,OAAOA,QAAP,MAAqB,cAArB;AACA,OAAOC,WAAP,MAAwB,aAAxB;AACA,MAAMC,sBAAsB,GAAG;AAC/B;AACAC,EAAAA,kBAAkB,EAAE,YAAY;AAChC,WAAOF,WAAW,CAACG,OAAZ,CAAoB,WAApB,CAAP;AACC,GAJ8B;AAK/B;AACAC,EAAAA,IAAI,EAAE,kBAAkB;AACxB,QAAI,CAACL,QAAQ,CAACM,IAAT,CAAcC,MAAnB,EAA2B;AAC3BP,MAAAA,QAAQ,CAACQ,aAAT,CAAuB;AACtBC,QAAAA,iBAAiB,EAAE;AADG,OAAvB;;AAGA,UAAI;AACJ,cAAMC,SAAS,GAAGV,QAAQ,CAACU,SAAT,EAAlB;AACA,cAAMC,kBAAkB,GAAG,MAAM,KAAKR,kBAAL,EAAjC,CAFI,CAGJ;;AACA,YAAIQ,kBAAkB,KAAK,IAA3B,EAAiC;AACjC,iBAAOA,kBAAP;AACC,SANG,CAOJ;;;AACA,cAAMC,MAAM,GAAG,MAAMC,YAAY,CAACC,iBAAb,EAArB;;AACA,YAAIF,MAAM,IAAIA,MAAM,KAAK,SAAzB,EAAoC;AACpC;AACA,gBAAMG,SAAS,GAAG,MAAML,SAAS,CAACM,QAAV,EAAxB;;AACA,cAAID,SAAJ,EAAe;AACf;AACAd,YAAAA,WAAW,CAACgB,OAAZ,CAAoB,WAApB,EAAiCC,KAAjC;AACAC,YAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBF,KAAzB,EAHe,CAIf;;AACA,mBAAOA,KAAP;AACC;AACA;AACA,OApBD,CAoBE,OAAOG,KAAP,EAAc;AAChBF,QAAAA,OAAO,CAACE,KAAR,CAAcA,KAAd;AACA,eAAO,IAAP;AACC;AACA;AACA;AApC8B,CAA/B;AAsCA,SAASnB,sBAAT","sourcesContent":["import 'firebase/messaging';\nimport firebase from 'firebase/app';\nimport localforage from 'localforage';\nconst firebaseCloudMessaging = {\n//checking whether token is available in indexed DB\ntokenInlocalforage: async () => {\nreturn localforage.getItem('fcm_token');\n},\n//initializing firebase app\ninit: async function () {\nif (!firebase.apps.length) {\nfirebase.initializeApp({\n messagingSenderId: \"447447903811\"\n});\ntry {\nconst messaging = firebase.messaging();\nconst tokenInLocalForage = await this.tokenInlocalforage();\n//if FCM token is already there just return the token\nif (tokenInLocalForage !== null) {\nreturn tokenInLocalForage;\n}\n//requesting notification permission from browser\nconst status = await Notification.requestPermission();\nif (status && status === 'granted') {\n//getting token from FCM\nconst fcm_token = await messaging.getToken();\nif (fcm_token) {\n//setting FCM token in indexed db using localforage\nlocalforage.setItem('fcm_token', token);\nconsole.log('fcm token', token);\n//return the FCM token after saving it\nreturn token;\n}\n}\n} catch (error) {\nconsole.error(error);\nreturn null;\n}\n}\n},\n};\nexport { firebaseCloudMessaging };"]},"metadata":{},"sourceType":"module"}