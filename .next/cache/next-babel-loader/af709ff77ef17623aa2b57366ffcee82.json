{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from \"react\";\nimport { SocialMediaIconsReact } from 'social-media-icons-react';\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props';\nimport Router from \"next/router\";\nimport axios from \"axios\";\nimport AnsAlert from \"../components/AnsAlert\";\nimport data from '../env.json';\n\nconst LoginButton = ({\n  facebookResponse\n}) => __jsx(FacebookLogin, {\n  appId: \"365959954585586\",\n  autoload: true,\n  fields: \"name,email,picture\",\n  callback: facebookResponse,\n  render: renderProps => __jsx(\"button\", {\n    style: {\n      backgroundColor: \"rgba(0,0,0,0)\",\n      border: \"none\"\n    },\n    onClick: renderProps.onClick\n  }, __jsx(SocialMediaIconsReact, {\n    borderColor: \"rgba(0,0,0,0.25)\",\n    borderWidth: \"3\",\n    borderStyle: \"inset\",\n    icon: \"facebook\",\n    iconColor: \"rgba(255,255,255,1)\",\n    backgroundColor: \"rgba(28,149,223,1)\",\n    iconSize: \"6\",\n    roundness: \"29%\",\n    size: \"54\"\n  }))\n});\n\nclass FbLog2 extends React.Component {\n  constructor() {\n    super();\n\n    _defineProperty(this, \"facebookResponse\", response => {\n      localStorage.setItem(\"email\", response.email);\n      localStorage.setItem(\"name\", response.name);\n      localStorage.setItem(\"image\", response.picture.data.url);\n      localStorage.setItem('token', response.accessToken);\n      axios.post(data.api + \"/api/facebooklogin\", {\n        accesstoken: response.accessToken,\n        expiration_time: response.data_access_expiration_time,\n        userID: response.userID\n      }).then(res => {\n        localStorage.setItem('token', res.data.access_token);\n        this.setState({\n          result: res.data.quiz_finished,\n          user: response,\n          isSignedIn: true,\n          access: res.data.access_token\n        }, () => {\n          if (localStorage.getItem('start') <= Date.now()) {\n            if (!res.data.quiz_finished && localStorage.getItem('end') > Date.now()) Router.push('/game');else if (res.data.quiz_finished && localStorage.getItem('end') > Date.now()) {\n              Router.push('/finale');\n            } else if (res.data.error === \"No active quizes\") {\n              Router.push('/finale');\n            } else {\n              Router.push('/error');\n            }\n          } else Router.reload();\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    });\n\n    this.state = {\n      user: false,\n      isSignedIn: false,\n      access: \"\",\n      result: false\n    };\n  }\n\n  componentDidMount() {\n    // if(localStorage.getItem(\"email\"))\n    // {\n    //   this.setState({isSignedIn:true},()=>{\n    //     if((localStorage.getItem('start') <= Date.now()))\n    //       Router.push(\"/game\");\n    //     else \n    //       {\n    //         AnsAlert(-1);\n    //       }\n    //   })\n    // }    \n    if (localStorage.getItem('day') == 3 && localStorage.getItem('end') < Date.now()) Router.push('/finale');else {\n      if (localStorage.getItem(\"email\")) {\n        this.setState({\n          isUserLoggedIn: true\n        }, () => {});\n      }\n    }\n  }\n\n  render() {\n    return __jsx(\"div\", null, !this.state.isSignedIn && __jsx(\"div\", {\n      style: {\n        margin: \"0 auto\",\n        textAlign: \"center\",\n        paddingTop: \"0px\"\n      }\n    }, __jsx(LoginButton, {\n      facebookResponse: this.facebookResponse\n    })));\n  }\n\n}\n\nexport default FbLog2;","map":null,"metadata":{},"sourceType":"module"}